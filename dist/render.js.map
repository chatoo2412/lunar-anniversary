{"version":3,"sources":["../src/render.ts"],"names":["add","remove","getNextAnniversary","formatDate","getDateDiff","initForm","addForm","document","addEventListener","event","preventDefault","name","nameInput","value","year","Number","yearInput","month","monthInput","day","dayInput","newEntry","lunarDate","renderItem","reset","key","item","content","querySelector","tr","createElement","td","deleteButton","textContent","appendChild","tagString","Date","insertAdjacentHTML","date","nextDate","lastElementChild"],"mappings":"AAAA,SAAqBA,GAArB,EAA0BC,MAA1B,QAAwC,cAAxC;AACA,SAASC,kBAAT,QAAmC,UAAnC;AACA,SAASC,UAAT,EAAqBC,WAArB,QAAwC,WAAxC;AAaA,OAAO,MAAMC,QAAQ,GAAG,MAAM;AAC5B,QAAM;AAAEC,IAAAA;AAAF,MAAcC,QAApB;AAEAD,EAAAA,OAAO,CAACE,gBAAR,CAAyB,QAAzB,EAAmCC,KAAK,IAAI;AAC1CA,IAAAA,KAAK,CAACC,cAAN;AAEA,UAAMC,IAAI,GAAGL,OAAO,CAACM,SAAR,CAAkBC,KAA/B;AACA,UAAMC,IAAI,GAAGC,MAAM,CAACT,OAAO,CAACU,SAAR,CAAkBH,KAAnB,CAAnB;AACA,UAAMI,KAAK,GAAGF,MAAM,CAACT,OAAO,CAACY,UAAR,CAAmBL,KAApB,CAApB;AACA,UAAMM,GAAG,GAAGJ,MAAM,CAACT,OAAO,CAACc,QAAR,CAAiBP,KAAlB,CAAlB;AAEA,UAAMQ,QAAQ,GAAGrB,GAAG,CAAC;AAAEW,MAAAA,IAAF;AAAQW,MAAAA,SAAS,EAAE;AAAER,QAAAA,IAAF;AAAQG,QAAAA,KAAR;AAAeE,QAAAA;AAAf;AAAnB,KAAD,CAApB;AAEAI,IAAAA,UAAU,CAACF,QAAD,CAAV;AAEAf,IAAAA,OAAO,CAACkB,KAAR;AACD,GAbD;AAcD,CAjBM;AAmBP,OAAO,MAAMD,UAAU,GAAG,OAAO;AAC/BE,EAAAA,GAD+B;AAE/BC,EAAAA,IAAI,EAAE;AAAEf,IAAAA,IAAF;AAAQW,IAAAA;AAAR;AAFyB,CAAP,KAGR;AAChB,QAAMK,OAAO,GAAGpB,QAAQ,CAACqB,aAAT,CAAuB,UAAvB,CAAhB;;AAEA,MAAI,CAACD,OAAL,EAAc;AACZ;AACD;;AAED,QAAME,EAAE,GAAGtB,QAAQ,CAACuB,aAAT,CAAuB,IAAvB,CAAX;AACA,QAAMC,EAAE,GAAGxB,QAAQ,CAACuB,aAAT,CAAuB,IAAvB,CAAX;AACA,QAAME,YAAY,GAAGzB,QAAQ,CAACuB,aAAT,CAAuB,QAAvB,CAArB;AAEAE,EAAAA,YAAY,CAACC,WAAb,GAA2B,IAA3B;AACAD,EAAAA,YAAY,CAACxB,gBAAb,CAA8B,OAA9B,EAAuCC,KAAK,IAAI;AAC9CR,IAAAA,MAAM,CAACwB,GAAD,CAAN,CAD8C,CAG9C;;AACAI,IAAAA,EAAE,CAAC5B,MAAH;AACD,GALD;AAOA8B,EAAAA,EAAE,CAACG,WAAH,CAAeF,YAAf;AACAH,EAAAA,EAAE,CAACK,WAAH,CAAeH,EAAf;AAEA,QAAMI,SAAS,GAAI;UACXxB,IAAK;UACLR,UAAU,CACd,IAAIiC,IAAJ,CAASd,SAAS,CAACR,IAAnB,EAAyBQ,SAAS,CAACL,KAAV,GAAkB,CAA3C,EAA8CK,SAAS,CAACH,GAAxD,CADc,CAEd;;CAJJ;AAQAU,EAAAA,EAAE,CAACQ,kBAAH,CAAsB,WAAtB,EAAmCF,SAAnC;AAEAR,EAAAA,OAAO,CAACO,WAAR,CAAoBL,EAApB;AAEA,QAAMS,IAAI,GAAG,MAAMpC,kBAAkB,CAACoB,SAAS,CAACL,KAAX,EAAkBK,SAAS,CAACH,GAA5B,CAArC;AAEA,QAAMoB,QAAQ,GAAGV,EAAE,CAACW,gBAApB;;AAEA,MAAI,CAACD,QAAL,EAAe;AACb;AACD;;AAEDA,EAAAA,QAAQ,CAACN,WAAT,GAAuBK,IAAI,GACtB,GAAEnC,UAAU,CAACmC,IAAD,CAAO,KAAIlC,WAAW,CAACkC,IAAD,CAAO,OADnB,GAEvB,IAFJ;AAGD,CAhDM","sourcesContent":["import { EntryModel, add, remove } from \"./storage.js\";\nimport { getNextAnniversary } from \"./api.js\";\nimport { formatDate, getDateDiff } from \"./date.js\";\n\ninterface AddFormModel extends HTMLFormElement {\n  nameInput: HTMLInputElement;\n  yearInput: HTMLInputElement;\n  monthInput: HTMLInputElement;\n  dayInput: HTMLInputElement;\n  submitButton: HTMLButtonElement;\n}\n\ninterface DocumentModel extends Document {\n  addForm: AddFormModel;\n}\nexport const initForm = () => {\n  const { addForm } = document as DocumentModel;\n\n  addForm.addEventListener(\"submit\", event => {\n    event.preventDefault();\n\n    const name = addForm.nameInput.value;\n    const year = Number(addForm.yearInput.value);\n    const month = Number(addForm.monthInput.value);\n    const day = Number(addForm.dayInput.value);\n\n    const newEntry = add({ name, lunarDate: { year, month, day } });\n\n    renderItem(newEntry);\n\n    addForm.reset();\n  });\n};\n\nexport const renderItem = async ({\n  key,\n  item: { name, lunarDate }\n}: EntryModel) => {\n  const content = document.querySelector(\"#content\");\n\n  if (!content) {\n    return;\n  }\n\n  const tr = document.createElement(\"tr\");\n  const td = document.createElement(\"td\");\n  const deleteButton = document.createElement(\"button\");\n\n  deleteButton.textContent = \"삭제\";\n  deleteButton.addEventListener(\"click\", event => {\n    remove(key);\n\n    // TODO. GC.\n    tr.remove();\n  });\n\n  td.appendChild(deleteButton);\n  tr.appendChild(td);\n\n  const tagString = `\n    <td>${name}</td>\n    <td>${formatDate(\n      new Date(lunarDate.year, lunarDate.month - 1, lunarDate.day)\n    )}</td>\n    <td>로딩중</td>\n`;\n\n  tr.insertAdjacentHTML(\"beforeend\", tagString);\n\n  content.appendChild(tr);\n\n  const date = await getNextAnniversary(lunarDate.month, lunarDate.day);\n\n  const nextDate = tr.lastElementChild;\n\n  if (!nextDate) {\n    return;\n  }\n\n  nextDate.textContent = date\n    ? `${formatDate(date)} (${getDateDiff(date)}일 남음)`\n    : \"오류\";\n};\n"],"file":"render.js"}