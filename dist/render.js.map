{"version":3,"sources":["../src/render.ts"],"names":["add","remove","getNextAnniversary","formatDate","getDateDiff","initForm","addForm","document","addEventListener","event","preventDefault","name","nameInput","value","year","Number","yearInput","month","monthInput","day","dayInput","newEntry","lunarDate","renderItem","reset","key","item","content","querySelector","tr","createElement","td","deleteButton","textContent","appendChild","insertAdjacentHTML","Date","date","sort","sorted","children","aElement","bElement","a","match","b","error","forEach","element","append"],"mappings":"AAAA,SAAqBA,GAArB,EAA0BC,MAA1B,QAAwC,cAAxC;AACA,SAASC,kBAAT,QAAmC,UAAnC;AACA,SAASC,UAAT,EAAqBC,WAArB,QAAwC,WAAxC;AAaA,OAAO,MAAMC,QAAQ,GAAG,MAAM;AAC5B,QAAM;AAAEC,IAAAA;AAAF,MAAcC,QAApB;AAEAD,EAAAA,OAAO,CAACE,gBAAR,CAAyB,QAAzB,EAAmCC,KAAK,IAAI;AAC1CA,IAAAA,KAAK,CAACC,cAAN;AAEA,UAAMC,IAAI,GAAGL,OAAO,CAACM,SAAR,CAAkBC,KAA/B;AACA,UAAMC,IAAI,GAAGC,MAAM,CAACT,OAAO,CAACU,SAAR,CAAkBH,KAAnB,CAAnB;AACA,UAAMI,KAAK,GAAGF,MAAM,CAACT,OAAO,CAACY,UAAR,CAAmBL,KAApB,CAApB;AACA,UAAMM,GAAG,GAAGJ,MAAM,CAACT,OAAO,CAACc,QAAR,CAAiBP,KAAlB,CAAlB;AAEA,UAAMQ,QAAQ,GAAGrB,GAAG,CAAC;AAAEW,MAAAA,IAAF;AAAQW,MAAAA,SAAS,EAAE;AAAER,QAAAA,IAAF;AAAQG,QAAAA,KAAR;AAAeE,QAAAA;AAAf;AAAnB,KAAD,CAApB;AAEAI,IAAAA,UAAU,CAACF,QAAD,CAAV;AAEAf,IAAAA,OAAO,CAACkB,KAAR;AACD,GAbD;AAcD,CAjBM;AAmBP,OAAO,MAAMD,UAAU,GAAG,OAAO;AAC/BE,EAAAA,GAD+B;AAE/BC,EAAAA,IAAI,EAAE;AAAEf,IAAAA,IAAF;AAAQW,IAAAA;AAAR;AAFyB,CAAP,KAGR;AAChB,QAAMK,OAAO,GAAGpB,QAAQ,CAACqB,aAAT,CAAuB,UAAvB,CAAhB;;AAEA,MAAI,CAACD,OAAL,EAAc;AACZ;AACD;;AAED,QAAME,EAAE,GAAGtB,QAAQ,CAACuB,aAAT,CAAuB,IAAvB,CAAX;AACA,QAAMC,EAAE,GAAGxB,QAAQ,CAACuB,aAAT,CAAuB,IAAvB,CAAX;AACA,QAAME,YAAY,GAAGzB,QAAQ,CAACuB,aAAT,CAAuB,QAAvB,CAArB;AAEAE,EAAAA,YAAY,CAACC,WAAb,GAA2B,IAA3B;AACAD,EAAAA,YAAY,CAACxB,gBAAb,CAA8B,OAA9B,EAAuCC,KAAK,IAAI;AAC9CR,IAAAA,MAAM,CAACwB,GAAD,CAAN,CAD8C,CAG9C;;AACAI,IAAAA,EAAE,CAAC5B,MAAH;AACD,GALD;AAOA8B,EAAAA,EAAE,CAACG,WAAH,CAAeF,YAAf;AACAH,EAAAA,EAAE,CAACK,WAAH,CAAeH,EAAf;AAEAF,EAAAA,EAAE,CAACM,kBAAH,CACE,WADF,EAEG;QACGxB,IAAK;QACLR,UAAU,CACd,IAAIiC,IAAJ,CAASd,SAAS,CAACR,IAAnB,EAAyBQ,SAAS,CAACL,KAAV,GAAkB,CAA3C,EAA8CK,SAAS,CAACH,GAAxD,CADc,CAEd;CANF;AAUAQ,EAAAA,OAAO,CAACO,WAAR,CAAoBL,EAApB;AAEA,QAAMQ,IAAI,GAAG,MAAMnC,kBAAkB,CAACoB,SAAS,CAACL,KAAX,EAAkBK,SAAS,CAACH,GAA5B,CAArC;AAEAU,EAAAA,EAAE,CAACM,kBAAH,CACE,WADF,EAEEE,IAAI,GACC;UACClC,UAAU,CAACkC,IAAD,CAAO;4BACCjC,WAAW,CAACiC,IAAD,CAAO;GAHtC,GAKC,aAPP;AAUA,SAAOA,IAAP;AACD,CAlDM;AAoDP,OAAO,MAAMC,IAAI,GAAG,MAAM;AACxB,QAAMX,OAAO,GAAGpB,QAAQ,CAACqB,aAAT,CAAuB,UAAvB,CAAhB;;AAEA,MAAI,CAACD,OAAL,EAAc;AACZ;AACD;;AAED,QAAMY,MAAM,GAAG,CAAC,GAAGZ,OAAO,CAACa,QAAZ,EAAsBF,IAAtB,CAA2B,CAACG,QAAD,EAAWC,QAAX,KAAwB;AAChE,QAAI;AACF,YAAMC,CAAC,GAAGF,QAAQ,CACfb,aADO,CACO,YADP,EAEPK,WAFO,CAEMW,KAFN,CAEY,KAFZ,EAEoB,CAFpB,CAAV;AAGA,YAAMC,CAAC,GAAGH,QAAQ,CACfd,aADO,CACO,YADP,EAEPK,WAFO,CAEMW,KAFN,CAEY,KAFZ,EAEoB,CAFpB,CAAV;AAIA,aAAO7B,MAAM,CAAC4B,CAAD,CAAN,GAAY5B,MAAM,CAAC8B,CAAD,CAAzB;AACD,KATD,CASE,OAAOC,KAAP,EAAc;AACd,aAAO,CAAP;AACD;AACF,GAbc,CAAf;AAeAP,EAAAA,MAAM,CAACQ,OAAP,CAAeC,OAAO,IAAIrB,OAAO,CAACsB,MAAR,CAAeD,OAAf,CAA1B;AACD,CAvBM","sourcesContent":["import { EntryModel, add, remove } from \"./storage.js\";\nimport { getNextAnniversary } from \"./api.js\";\nimport { formatDate, getDateDiff } from \"./date.js\";\n\ninterface AddFormModel extends HTMLFormElement {\n  nameInput: HTMLInputElement;\n  yearInput: HTMLInputElement;\n  monthInput: HTMLInputElement;\n  dayInput: HTMLInputElement;\n  submitButton: HTMLButtonElement;\n}\n\ninterface DocumentModel extends Document {\n  addForm: AddFormModel;\n}\nexport const initForm = () => {\n  const { addForm } = document as DocumentModel;\n\n  addForm.addEventListener(\"submit\", event => {\n    event.preventDefault();\n\n    const name = addForm.nameInput.value;\n    const year = Number(addForm.yearInput.value);\n    const month = Number(addForm.monthInput.value);\n    const day = Number(addForm.dayInput.value);\n\n    const newEntry = add({ name, lunarDate: { year, month, day } });\n\n    renderItem(newEntry);\n\n    addForm.reset();\n  });\n};\n\nexport const renderItem = async ({\n  key,\n  item: { name, lunarDate }\n}: EntryModel) => {\n  const content = document.querySelector(\"#content\");\n\n  if (!content) {\n    return;\n  }\n\n  const tr = document.createElement(\"tr\");\n  const td = document.createElement(\"td\");\n  const deleteButton = document.createElement(\"button\");\n\n  deleteButton.textContent = \"삭제\";\n  deleteButton.addEventListener(\"click\", event => {\n    remove(key);\n\n    // TODO. GC.\n    tr.remove();\n  });\n\n  td.appendChild(deleteButton);\n  tr.appendChild(td);\n\n  tr.insertAdjacentHTML(\n    \"beforeend\",\n    `\n  <td>${name}</td>\n  <td>${formatDate(\n    new Date(lunarDate.year, lunarDate.month - 1, lunarDate.day)\n  )}</td>\n`\n  );\n\n  content.appendChild(tr);\n\n  const date = await getNextAnniversary(lunarDate.month, lunarDate.day);\n\n  tr.insertAdjacentHTML(\n    \"beforeend\",\n    date\n      ? `\n    <td>${formatDate(date)}</td>\n    <td class=\"remaining\">${getDateDiff(date)}일</td>\n  `\n      : `<td>오류</td>`\n  );\n\n  return date;\n};\n\nexport const sort = () => {\n  const content = document.querySelector(\"#content\");\n\n  if (!content) {\n    return;\n  }\n\n  const sorted = [...content.children].sort((aElement, bElement) => {\n    try {\n      const a = aElement\n        .querySelector(\".remaining\")!\n        .textContent!.match(/\\d+/)![0];\n      const b = bElement\n        .querySelector(\".remaining\")!\n        .textContent!.match(/\\d+/)![0];\n\n      return Number(a) - Number(b);\n    } catch (error) {\n      return 0;\n    }\n  });\n\n  sorted.forEach(element => content.append(element));\n};\n"],"file":"render.js"}